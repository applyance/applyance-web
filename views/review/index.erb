<!DOCTYPE html>
<html>
  <head>
    <title>Applyance</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/png" href="/img/favicon.png">

    <base href="/">
    <link rel="stylesheet" type="text/css" href="//cloud.typography.com/7222252/709524/css/fonts.css" />
    <link rel="stylesheet" type="text/css" href="/styles/css/normalize.css" />
    <link rel="stylesheet" type="text/css" href="/styles/css/base.css" />
    <link rel="stylesheet" type="text/css" href="/styles/css/review.css" />
  </head>
  <body ng-app="Review">

    <header class="header" ng-controller="HeaderCtrl">
      <a href="{{ context.group }}/{{ context.id }}/applications" class="mark">
        <span class="mark__helper"></span>
        <img src="/img/mark.blue.png" class="mark__img">
      </a>
      <nav class="nav">
        <ul class="nav__list group">
          <li class="nav__item"
              ng-class="{ 'is-active':isActive('/' + context.group + '/' + context.id + '/applications') }">
            <a href="{{ context.group }}/{{ context.id }}/applications"
               class="nav__link">Applications</a>
          </li>
          <li class="nav__item"
              ng-class="{ 'is-active':inSettings }">
            <a href="{{ context.group }}/{{ context.id }}/settings"
               class="nav__link">Settings</a>
          </li>
        <ul>
      </nav>
      <div class="account" ng-controller="AccountCtrl">

        <div class="selector">
          <select class="account__context" ng-model="activeContextOption"
                  ng-options="contextOption.name for contextOption in contextOptions"
                  ng-change="updateContextSelect()"></select>
        </div>

        <img src="{{ getAvatarURL() }}" class="account__avatar" />

        <ul class="account__settings-list">

          <li class="account__settings-item">
            <a href="/accounts/{{ me.account.id }}/settings" target="_self" class="account__settings-link" title="Account Settings">
              <i class="icon-settings"></i>
            </a>
          </li>

          <li class="account__settings-item">
            <a href="/accounts/logout" target="_self" class="account__settings-link" title="Sign Out">
              <i class="icon-logout"></i>
            </a>
          </li>
        </ul>
      </div>
    </header>

    <div class="flash text-trim" ng-show="flashMessage">
      <p>{{ flashMessage }}</p>
    </div>

    <main class="main" ng-view></main>

    <script type="text/javascript" src="/scripts/ext/angular/angular.min.js"></script>
    <script type="text/javascript" src="/scripts/ext/angular-route/angular-route.min.js"></script>
    <script type="text/javascript" src="/scripts/ext/underscore/underscore.js"></script>
    <script type="text/javascript" src="/scripts/ext/restangular/dist/restangular.min.js"></script>
    <script type="text/javascript" src="/scripts/ext/moment/min/moment.min.js"></script>
    <script type="text/javascript" src="/scripts/ext/angular-moment/angular-moment.min.js"></script>
    <script type="text/javascript" src="/scripts/ext/cryptojslib/rollups/md5.js"></script>

    <script type="text/javascript" src="/scripts/services/api.js"></script>

    <script type="text/javascript" src="/scripts/review/app.js"></script>
    <script type="text/javascript" src="/scripts/review/directives.js"></script>
    <script type="text/javascript" src="/scripts/review/filters.js"></script>

    <script type="text/javascript" src="/scripts/review/services/me.js"></script>
    <script type="text/javascript" src="/scripts/review/services/context.js"></script>
    <script type="text/javascript" src="/scripts/review/services/flash.js"></script>

    <script type="text/javascript" src="/scripts/review/controllers/header/header.js"></script>
    <script type="text/javascript" src="/scripts/review/controllers/header/account.js"></script>

    <script type="text/javascript" src="/scripts/review/controllers/applications.js"></script>
    <script type="text/javascript" src="/scripts/review/controllers/application.js"></script>
    <script type="text/javascript" src="/scripts/review/controllers/settings.js"></script>
    <script type="text/javascript" src="/scripts/review/controllers/account.js"></script>

    <script type="text/javascript" src="/scripts/review/controllers/entities/blueprints.js"></script>
    <script type="text/javascript" src="/scripts/review/controllers/entities/entities.js"></script>
    <script type="text/javascript" src="/scripts/review/controllers/entities/reviewers.js"></script>
    <script type="text/javascript" src="/scripts/review/controllers/entities/settings.js"></script>
    <script type="text/javascript" src="/scripts/review/controllers/entities/labels.js"></script>

    <script>
      var app = angular.module('Applyance');
      app.constant('me', <%= JSON.dump(@me) %>);
      app.constant('apiHost', '<%= @api_host %>');
      app.constant('apiKey', '<%= @api_key %>');
    </script>

  </body>
</html>
